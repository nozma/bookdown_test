---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
output_dir: docs
---

# はじめに

とりあえず細かいセッティングは抜きにして手元のRmdファイルをGitHub上に公開したい、という気持ちだったので最低限の手順をまとめました。

## 事前準備

- `bookdown`パッケージをインストールしていなければインストールしておく。

```r
install.packages("bookdown")
```

- githubで新規リポジトリを作成する。
- RStudioから`New Project -> VersionControl -> Git`と選択し、Repository URLに先程作成したリポジトリのURLを指定、新規プロジェクトを作成する。

## Rmdファイルについて

- デフォルトではプロジェクトのトップディレクトリに配置されたRmdファイルが結合されたのち、Knitされる。
    - 全てのRmdファイルが1つのRmdファイルとして評価されるので、例えば設定用のコードチャンクは先頭のファイルに1回書いてあればよい。
    - チャンクラベルが重複しないように注意する必要がある。
- デフォルトではRmdファイルの結合順序は名前順である。
    - ファイル名の先頭に数字を入れると良い。例えば`01_first.Rmd`の次は`02_second.Rmd`といった具合に。
    - ただし、`index.Rmd`というファイルがあれば、常に最初のファイルとして使用される。
    - アンダースコア`_`から始まるファイルは無視される。
    
注: 上記の挙動は当然変更できるが、ここでは説明しない。

## YAMLフィールドの指定

各種の設定は最初のRmdファイル(前述の通り、通常は`index.Rmd`)のヘッダーにYAMLフロントマターとして記述する。以下に最低限の記述を示す。

```yml
---
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
output_dir: docs  
---
```

- `site: bookdown::bookdown_site`は`bookdown::render_book()`を呼び出すために必要な設定らしい。
- `output`フィールドで出力形式を指定する。
- `output_dir`は出力先ディレクトリを指定する。GitHubでサイトとして公開するためには`docs/`以下に出力する必要がある。

注: `_bookdown.yml`や`_output.yml`というファイルに設定を分散させることもできるが、ここでは説明しない。著者やタイトルみたいな情報も含められるが、これも説明しない。

## ビルド

- BuildタブのBuild Bookをクリック。
    - Buildタブが無い場合はファイルを保存してRStudioを開き直すと出る。多分。
    
## 公開

- GitタブからCommitしてPush
- GitHubのリポジトリページを開き、Settingsタブの下の方のGitHub PagesのSourceをmaster branch /docs folderに変更してSave
- 今設定したGitHub　Pagesの欄に"Your site is published at ..."と説明が出ているので、そこからリンク先へ飛ぶとdocsフォルダ以下の内容が公開されている。
    - Save直後は404が表示される。反映まで10分くらいかかることがある。
